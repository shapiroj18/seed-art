<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
	<link rel="icon" type="image/png" href="img/barley.png"/>
    <title>Crop Art</title>
    <style>
	  div {
		height: 500px;
		width: 100%;
		border-style: solid;
		border-width: 1px;
	  }

	  img, input {
		object-fit: cover;
		width: 20px;
		height: 20px;
	  }
    </style>
  </head>
  <body>
	<input type="image" src="img/navy-bean.png" onclick="addSeed('img/navy-bean.png')"/>
	<div id="canvas">
	</div>
	<script>
		function addSeed(imgSrc) {
			let img = document.createElement("img")
			img.id = crypto.randomUUID()
			img.src = imgSrc
			img.draggable = true
			img.onDragStart = "dragStartHandler(event)"
			document.getElementById('canvas').appendChild(img);
			makeImageDraggable(img)
		}

		function dragStartHandler(event) {
			event.dataTransfer.setData("image/png", event.target.id)
			event.dataTransfer.effectAllowed = "move"
		}

		function makeImageDraggable(img) {
			const canvas = document.getElementById("canvas");

			const draggableImg = document.getElementById(img.id);
			draggableImg.addEventListener("dragstart", (event) => {
				dragged = event.target;
			});

			canvas.addEventListener("drop", (event) => {
				event.preventDefault();
				dragged.parentNode.removeChild(dragged);
				dragged.style.position = 'absolute'
				dragged.style.left = `${event.clientX}px`
				dragged.style.top = `${event.clientY}px`
				event.target.appendChild(dragged);
			});
		}

		// make canvas draggable target
		const canvas = document.getElementById("canvas");

		canvas.addEventListener("dragenter", (event) => {
			event.preventDefault();
		});

		canvas.addEventListener("dragover", (event) => {
			event.preventDefault();
		});
    </script>
  </body>
</html>
